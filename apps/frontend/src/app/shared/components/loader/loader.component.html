<!-- Loader Component Template -->
<div 
  class="loader-overlay" 
  [class.fullscreen]="fullscreen"
  [class.inline]="!fullscreen"
  [class.backdrop-blur]="backdropBlur"
  [@fadeIn]
  role="progressbar"
  [attr.aria-label]="message || ('loader.loading' | translate)"
  [attr.aria-busy]="true"
  [attr.aria-valuemin]="progressMode === 'determinate' ? 0 : null"
  [attr.aria-valuemax]="progressMode === 'determinate' ? 100 : null"
  [attr.aria-valuenow]="progressMode === 'determinate' ? progress : null"
>
  <div 
    class="loader-container"
    [class.loader-small]="size === 'small'"
    [class.loader-medium]="size === 'medium'"
    [class.loader-large]="size === 'large'"
  >
    <!-- Spinner Type Loader -->
    <div class="spinner-wrapper" *ngIf="type === 'spinner'">
      <mat-progress-spinner
        [mode]="progressMode"
        [value]="progress"
        [diameter]="spinnerDiameter"
        [strokeWidth]="strokeWidth"
        [color]="color"
        class="spinner"
      ></mat-progress-spinner>
      
      <!-- Center Icon or Text -->
      <div class="spinner-center" *ngIf="showCenterContent && progressMode === 'determinate'">
        <mat-icon *ngIf="centerIcon" class="center-icon">{{ centerIcon }}</mat-icon>
        <span *ngIf="!centerIcon && progress" class="center-text">{{ progress }}%</span>
      </div>
    </div>
    
    <!-- Bar Type Loader -->
    <div class="bar-wrapper" *ngIf="type === 'bar'">
      <mat-progress-bar
        [mode]="progressMode"
        [value]="progress"
        [color]="color"
        [bufferValue]="bufferValue"
        class="progress-bar"
      ></mat-progress-bar>
    </div>
    
    <!-- Dots Type Loader -->
    <div class="dots-wrapper" *ngIf="type === 'dots'">
      <span 
        class="dot" 
        *ngFor="let dot of dots; let i = index"
        [style.animation-delay.ms]="i * 160"
        [class.dot-primary]="color === 'primary'"
        [class.dot-accent]="color === 'accent'"
        [class.dot-warn]="color === 'warn'"
      ></span>
    </div>
    
    <!-- Pulse Type Loader -->
    <div class="pulse-wrapper" *ngIf="type === 'pulse'">
      <div 
        class="pulse-ring"
        [class.pulse-primary]="color === 'primary'"
        [class.pulse-accent]="color === 'accent'"
        [class.pulse-warn]="color === 'warn'"
      ></div>
      <div 
        class="pulse-ring pulse-ring-2"
        [class.pulse-primary]="color === 'primary'"
        [class.pulse-accent]="color === 'accent'"
        [class.pulse-warn]="color === 'warn'"
      ></div>
      <div 
        class="pulse-ring pulse-ring-3"
        [class.pulse-primary]="color === 'primary'"
        [class.pulse-accent]="color === 'accent'"
        [class.pulse-warn]="color === 'warn'"
      ></div>
    </div>
    
    <!-- Skeleton Type Loader -->
    <div class="skeleton-wrapper" *ngIf="type === 'skeleton'">
      <div class="skeleton-header">
        <div class="skeleton-avatar"></div>
        <div class="skeleton-lines">
          <div class="skeleton-line skeleton-line-short"></div>
          <div class="skeleton-line skeleton-line-medium"></div>
        </div>
      </div>
      <div class="skeleton-body">
        <div class="skeleton-line"></div>
        <div class="skeleton-line"></div>
        <div class="skeleton-line skeleton-line-short"></div>
      </div>
    </div>
    
    <!-- Custom Content -->
    <div class="custom-content" *ngIf="type === 'custom'">
      <ng-content></ng-content>
    </div>
    
    <!-- Message -->
    <div 
      class="loader-message" 
      *ngIf="message"
      [class.message-above]="messagePosition === 'above'"
      [class.message-below]="messagePosition === 'below'"
    >
      <span class="message-text">{{ message | translate }}</span>
      <span class="message-dots" *ngIf="showMessageDots">
        <span class="message-dot"></span>
        <span class="message-dot"></span>
        <span class="message-dot"></span>
      </span>
    </div>
    
    <!-- Secondary Message -->
    <div class="loader-secondary-message" *ngIf="secondaryMessage">
      {{ secondaryMessage | translate }}
    </div>
    
    <!-- Action Button -->
    <button 
      mat-button
      *ngIf="showCancelButton"
      (click)="onCancel()"
      class="cancel-button"
      [disabled]="cancelDisabled"
      [attr.aria-label]="'loader.cancel' | translate"
    >
      <mat-icon>close</mat-icon>
      {{ cancelButtonText || ('loader.cancel' | translate) }}
    </button>
    
    <!-- Progress Details -->
    <div class="progress-details" *ngIf="showProgressDetails && progressMode === 'determinate'">
      <div class="progress-text">
        <span class="progress-current">{{ processedItems }}</span>
        <span class="progress-separator">/</span>
        <span class="progress-total">{{ totalItems }}</span>
      </div>
      <div class="progress-time" *ngIf="estimatedTime">
        <mat-icon class="time-icon">schedule</mat-icon>
        <span>{{ estimatedTime }}</span>
      </div>
    </div>
  </div>
  
  <!-- Background Pattern -->
  <div 
    class="background-pattern" 
    *ngIf="showBackgroundPattern"
    [class.pattern-dots]="backgroundPattern === 'dots'"
    [class.pattern-grid]="backgroundPattern === 'grid'"
    [class.pattern-lines]="backgroundPattern === 'lines'"
  ></div>
</div>
